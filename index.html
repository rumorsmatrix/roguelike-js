<!DOCTYPE html>
<html>
<head>
<title>untitled dungeon crawling / ROT.js project</title>
<link href="css/game.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Fira+Mono" rel="stylesheet" type="text/css">
<style>

/*
	TO DO:
	set up some mobile/tablet detection and show a sorry page
*/

</style>
</head>
<body>
<div id="game_container">

	<div id="subscreen_container">
		<div id="subscreen_main_menu">
			<p>
				<u>Main menu</u><br>
				<strong>n</strong>ew game<br>
				<strong>l</strong>oad saved game<br>
				<br>
				visit the <strong>w</strong>ebsite<br>
				follow me on <strong>t</strong>witter
			</p>
		</div>
	</div>

	<div id="header_container">
		untitled dungeon crawling / ROT.js project
	</div>

	<div id="sidebar_container">

		<p>
			<div id="player_avatar">
				<img id="player_avatar_img" src="imgs/quale-scroll.png">
			</div>
		</p>

		<p>
			<u><span id="player_name"></span></u><br>
			Health: 10/10<br>
		</p>

		<p>
			<u>Inventory</u><br>
			Hands: Sword, shield<br>
			Body: Leather armour<br>
			Gold: 20gp<br>
		</p>

		<p>
			<u>Commands</u><br>
			<strong>i</strong>nventory<br>
			<strong>w</strong>ait<br>
			<span id="commands_doors_open" class="hidden"><strong>o</strong>pen door<br></span>
			<span id="commands_doors_close" class="hidden"><strong>c</strong>lose door<br></span>
		</p>

	</div>

	<div id="map_container"></div>
	<div id="log_container"></div>
</div>
<script src="js/log.js"></script>
<script src="js/game.js"></script>
<script src="js/grammar.js"></script>
<script src="js/rot.js"></script>
<script src="js/map.js"></script>
<script src="js/tile_library.js"></script>
<script src="js/entity.js"></script>
<script>

var tile_set_image = document.createElement("img");
tile_set_image.src = "imgs/quale-scroll.png";
ROT.Display.Rect.cache = true

// TODO
// have the tile_library generate the tileMap array map so everything can be defined in the same place...

game.display = new ROT.Display({
	layout: "tile",
	tileSet: tile_set_image,
	bg: "#000",
	tileWidth: 16,
	tileHeight: 16,
	tileMap: {

		// tiles prefixed with _ are in the fog-of-war

		// empty space
		" ": 	[0, 32],

		// walls
		"#": 	[0, 320],
		"_#": 	[0, 304],
		"#2": 	[16, 320],
		"_#2": 	[16, 304],
		"#3": 	[32, 320],
		"_#3": 	[32, 304],

		// floors
		".": 	[192, 352],
		"_.": 	[192, 336],

		// doors
		"+": 	[192, 320],
		"_+": 	[192, 304],
		"-": 	[208, 320],
		"_-": 	[208, 304],

		// player, monsters, NPCs
		"@": [32, 0],
		"r": [0, 128],
	},

	fontFamily: "monospace",
	fontSize: 14,
	forceSquareRatio: true,

	width: game.display_width,
	height: game.display_height
});
document.getElementById("map_container").appendChild(game.display.getContainer());

// TODO: the game.map should be inside an array? Or have a game.atlas array for storing other maps, game.map is always the current one?
game.map = new Map(game.map_width, game.map_height); // TODO: make this a maximum and allow variable dungeon sizes?
game.map.generate_dungeon(); // TODO: variable dungeon size?

game.player = new Player();

// turn off key listener
// window.removeEventListener("keydown", game.player);


if (tile_set_image.complete) {
	game.map.draw();
} else {
	tile_set_image.addEventListener("load", game.map.draw);
}


</script>
</body>
</html>
